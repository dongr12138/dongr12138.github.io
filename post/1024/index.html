<!DOCTYPE html>
<html lang="en-us">
<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="author" content="rui">
  <meta name="description" content="我不接受批评，你如果说我，我就骂你">
  <meta name="generator" content="Hugo 0.58.3" />

  <title>1024-Springboot Web开发（2） &middot; Maybe...</title>

  <link rel="shortcut icon" href="https://dongr12138.github.io/images/favicon.ico">
  <link rel="stylesheet" href="https://dongr12138.github.io/css/spectre.min.css">
  <link rel="stylesheet" href="https://dongr12138.github.io/css/style.css">
  <link rel="stylesheet" href="https://dongr12138.github.io/css/highlight.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.9.0/css/all.min.css">
  
    <link rel="stylesheet" href="https://cdn.rawgit.com/konpa/devicon/df6431e323547add1b4cf45992913f15286456d3/devicon.min.css">
  

  
    <link href="" rel="alternate" type="application/rss+xml" title="Maybe..." />
  

  
  <meta property="og:title" content="1024-Springboot Web开发（2）" />
<meta property="og:description" content="无论头上是怎样的天空，我准备承受任何风暴。 -拜伦-
4、SpringMVC自动配置 https://docs.spring.io/spring-boot/docs/1.5.10.RELEASE/reference/htmlsingle/#boot-features-developing-web-applications
1. Spring MVC auto-configuration Spring Boot 自动配置好了SpringMVC
以下是SpringBoot对SpringMVC的默认配置:==（WebMvcAutoConfiguration）==
 Inclusion of ContentNegotiatingViewResolver and BeanNameViewResolver beans.
 自动配置了ViewResolver（视图解析器：根据方法的返回值得到视图对象（View），视图对象决定如何渲染（转发？重定向？）） ContentNegotiatingViewResolver：组合所有的视图解析器的； ==如何定制：我们可以自己给容器中添加一个视图解析器；自动的将其组合进来；==  Support for serving static resources, including support for WebJars (see below).静态资源文件夹路径,webjars
 Static index.html support. 静态首页访问
 Custom Favicon support (see below). favicon.ico
 自动注册了 of Converter, GenericConverter, Formatter beans.
 Converter：转换器； public String hello(User user)：类型转换使用Converter Formatter 格式化器； 2017.12.17===Date；
@Bean @ConditionalOnProperty(prefix = &quot;spring.mvc&quot;, name = &quot;date-format&quot;)//在文件中配置日期格式化的规则 public Formatter&lt;Date&gt; dateFormatter() { return new DateFormatter(this." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://dongr12138.github.io/post/1024/" />
<meta property="article:published_time" content="2019-10-24T23:03:54+08:00" />
<meta property="article:modified_time" content="2019-10-24T23:03:54+08:00" />

  
  <meta itemprop="name" content="1024-Springboot Web开发（2）">
<meta itemprop="description" content="无论头上是怎样的天空，我准备承受任何风暴。 -拜伦-
4、SpringMVC自动配置 https://docs.spring.io/spring-boot/docs/1.5.10.RELEASE/reference/htmlsingle/#boot-features-developing-web-applications
1. Spring MVC auto-configuration Spring Boot 自动配置好了SpringMVC
以下是SpringBoot对SpringMVC的默认配置:==（WebMvcAutoConfiguration）==
 Inclusion of ContentNegotiatingViewResolver and BeanNameViewResolver beans.
 自动配置了ViewResolver（视图解析器：根据方法的返回值得到视图对象（View），视图对象决定如何渲染（转发？重定向？）） ContentNegotiatingViewResolver：组合所有的视图解析器的； ==如何定制：我们可以自己给容器中添加一个视图解析器；自动的将其组合进来；==  Support for serving static resources, including support for WebJars (see below).静态资源文件夹路径,webjars
 Static index.html support. 静态首页访问
 Custom Favicon support (see below). favicon.ico
 自动注册了 of Converter, GenericConverter, Formatter beans.
 Converter：转换器； public String hello(User user)：类型转换使用Converter Formatter 格式化器； 2017.12.17===Date；
@Bean @ConditionalOnProperty(prefix = &quot;spring.mvc&quot;, name = &quot;date-format&quot;)//在文件中配置日期格式化的规则 public Formatter&lt;Date&gt; dateFormatter() { return new DateFormatter(this.">


<meta itemprop="datePublished" content="2019-10-24T23:03:54&#43;08:00" />
<meta itemprop="dateModified" content="2019-10-24T23:03:54&#43;08:00" />
<meta itemprop="wordCount" content="347">



<meta itemprop="keywords" content="" />

  <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="1024-Springboot Web开发（2）"/>
<meta name="twitter:description" content="无论头上是怎样的天空，我准备承受任何风暴。 -拜伦-
4、SpringMVC自动配置 https://docs.spring.io/spring-boot/docs/1.5.10.RELEASE/reference/htmlsingle/#boot-features-developing-web-applications
1. Spring MVC auto-configuration Spring Boot 自动配置好了SpringMVC
以下是SpringBoot对SpringMVC的默认配置:==（WebMvcAutoConfiguration）==
 Inclusion of ContentNegotiatingViewResolver and BeanNameViewResolver beans.
 自动配置了ViewResolver（视图解析器：根据方法的返回值得到视图对象（View），视图对象决定如何渲染（转发？重定向？）） ContentNegotiatingViewResolver：组合所有的视图解析器的； ==如何定制：我们可以自己给容器中添加一个视图解析器；自动的将其组合进来；==  Support for serving static resources, including support for WebJars (see below).静态资源文件夹路径,webjars
 Static index.html support. 静态首页访问
 Custom Favicon support (see below). favicon.ico
 自动注册了 of Converter, GenericConverter, Formatter beans.
 Converter：转换器； public String hello(User user)：类型转换使用Converter Formatter 格式化器； 2017.12.17===Date；
@Bean @ConditionalOnProperty(prefix = &quot;spring.mvc&quot;, name = &quot;date-format&quot;)//在文件中配置日期格式化的规则 public Formatter&lt;Date&gt; dateFormatter() { return new DateFormatter(this."/>

</head>

<body onload="setPixelFont()">
  <div class="container p-fixed" style="z-index:3">
  <nav class="navbar m-2 p-2 s-rounded shadow bg-primary">
    <section class="navbar-section">
      <button class="btn btn-action btn-primary s-circle text-gray" id="pixelfont-toggle"><i class="fas fa-robot fa-lg"></i></button>
    </section>
    <section class="navbar-section">
      
        <a class="btn btn-primary" href='https://dongr12138.github.io/'>Home</a>
      

      

      
      <a class="btn btn-accent" href="" target="_blank"><i class="fas fa-rss fa-lg"></i></a>
      
    </section>
  </nav>
</div>

  <section class="container grid-md">
  <div class="columns">
    
    
<article class="container p-centered mt-space">
  <header>
    <h2 class="text-center">1024-Springboot Web开发（2）</h2>
    <h6 class="text-gray text-italic"></h6>
  </header>
  <section class="my-gap">
    

<p>无论头上是怎样的天空，我准备承受任何风暴。        -拜伦-</p>

<h2 id="4-springmvc自动配置">4、SpringMVC自动配置</h2>

<p><a href="https://docs.spring.io/spring-boot/docs/1.5.10.RELEASE/reference/htmlsingle/#boot-features-developing-web-applications">https://docs.spring.io/spring-boot/docs/1.5.10.RELEASE/reference/htmlsingle/#boot-features-developing-web-applications</a></p>

<h3 id="1-spring-mvc-auto-configuration">1. Spring MVC auto-configuration</h3>

<p>Spring Boot 自动配置好了SpringMVC</p>

<p>以下是SpringBoot对SpringMVC的默认配置:<strong>==（WebMvcAutoConfiguration）==</strong></p>

<ul>
<li><p>Inclusion of <code>ContentNegotiatingViewResolver</code> and <code>BeanNameViewResolver</code> beans.</p>

<ul>
<li>自动配置了ViewResolver（视图解析器：根据方法的返回值得到视图对象（View），视图对象决定如何渲染（转发？重定向？））</li>
<li>ContentNegotiatingViewResolver：组合所有的视图解析器的；</li>
<li>==如何定制：我们可以自己给容器中添加一个视图解析器；自动的将其组合进来；==</li>
</ul></li>

<li><p>Support for serving static resources, including support for WebJars (see below).静态资源文件夹路径,webjars</p></li>

<li><p>Static <code>index.html</code> support. 静态首页访问</p></li>

<li><p>Custom <code>Favicon</code> support (see below).  favicon.ico</p></li>

<li><p>自动注册了 of <code>Converter</code>, <code>GenericConverter</code>, <code>Formatter</code> beans.</p>

<ul>
<li>Converter：转换器；  public String hello(User user)：类型转换使用Converter</li>

<li><p><code>Formatter</code>  格式化器；  2017.12.17===Date；</p>

<pre><code class="language-java">		@Bean
		@ConditionalOnProperty(prefix = &quot;spring.mvc&quot;, name = &quot;date-format&quot;)//在文件中配置日期格式化的规则
		public Formatter&lt;Date&gt; dateFormatter() {
			return new DateFormatter(this.mvcProperties.getDateFormat());//日期格式化组件
		}
</code></pre></li>
</ul></li>
</ul>

<p>​   ==自己添加的格式化器转换器，我们只需要放在容器中即可==</p>

<ul>
<li><p>Support for <code>HttpMessageConverters</code> (see below).</p>

<ul>
<li><p>HttpMessageConverter：SpringMVC用来转换Http请求和响应的；User&mdash;Json；</p></li>

<li><p><code>HttpMessageConverters</code> 是从容器中确定；获取所有的HttpMessageConverter；</p></li>
</ul>

<p>==自己给容器中添加HttpMessageConverter，只需要将自己的组件注册容器中（@Bean,@Component）==</p></li>

<li><p>Automatic registration of <code>MessageCodesResolver</code> (see below).定义错误代码生成规则</p></li>

<li><p>Automatic use of a <code>ConfigurableWebBindingInitializer</code> bean (see below).</p></li>
</ul>

<p>==我们可以配置一个ConfigurableWebBindingInitializer来替换默认的；（添加到容器）==</p>

<pre><code>  初始化WebDataBinder；
  请求数据=====JavaBean；
</code></pre>

<p><strong>org.springframework.boot.autoconfigure.web：web的所有自动场景；</strong></p>

<p>If you want to keep Spring Boot MVC features, and you just want to add additional <a href="https://docs.spring.io/spring/docs/4.3.14.RELEASE/spring-framework-reference/htmlsingle#mvc">MVC configuration</a> (interceptors, formatters, view controllers etc.) you can add your own <code>@Configuration</code> class of type <code>WebMvcConfigurerAdapter</code>, but <strong>without</strong> <code>@EnableWebMvc</code>. If you wish to provide custom instances of <code>RequestMappingHandlerMapping</code>, <code>RequestMappingHandlerAdapter</code> or <code>ExceptionHandlerExceptionResolver</code> you can declare a <code>WebMvcRegistrationsAdapter</code> instance providing such components.</p>

<p>If you want to take complete control of Spring MVC, you can add your own <code>@Configuration</code> annotated with <code>@EnableWebMvc</code>.</p>

<h3 id="2-扩展springmvc">2、扩展SpringMVC</h3>

<pre><code class="language-xml">    &lt;mvc:view-controller path=&quot;/hello&quot; view-name=&quot;success&quot;/&gt;
    &lt;mvc:interceptors&gt;
        &lt;mvc:interceptor&gt;
            &lt;mvc:mapping path=&quot;/hello&quot;/&gt;
            &lt;bean&gt;&lt;/bean&gt;
        &lt;/mvc:interceptor&gt;
    &lt;/mvc:interceptors&gt;
</code></pre>

<p><strong>==编写一个配置类（@Configuration），是WebMvcConfigurerAdapter类型；不能标注@EnableWebMvc==</strong>;</p>

<p>既保留了所有的自动配置，也能用我们扩展的配置；</p>

<pre><code class="language-java">//使用WebMvcConfigurerAdapter可以来扩展SpringMVC的功能
@Configuration
public class MyMvcConfig extends WebMvcConfigurerAdapter {

    @Override
    public void addViewControllers(ViewControllerRegistry registry) {
       // super.addViewControllers(registry);
        //浏览器发送 /atguigu 请求来到 success
        registry.addViewController(&quot;/atguigu&quot;).setViewName(&quot;success&quot;);
    }
}
</code></pre>

<p>原理：</p>

<p>​   1）、WebMvcAutoConfiguration是SpringMVC的自动配置类</p>

<p>​   2）、在做其他自动配置时会导入；@Import(<strong>EnableWebMvcConfiguration</strong>.class)</p>

<pre><code class="language-java">    @Configuration
	public static class EnableWebMvcConfiguration extends DelegatingWebMvcConfiguration {
      private final WebMvcConfigurerComposite configurers = new WebMvcConfigurerComposite();

	 //从容器中获取所有的WebMvcConfigurer
      @Autowired(required = false)
      public void setConfigurers(List&lt;WebMvcConfigurer&gt; configurers) {
          if (!CollectionUtils.isEmpty(configurers)) {
              this.configurers.addWebMvcConfigurers(configurers);
            	//一个参考实现；将所有的WebMvcConfigurer相关配置都来一起调用；  
            	@Override
             // public void addViewControllers(ViewControllerRegistry registry) {
              //    for (WebMvcConfigurer delegate : this.delegates) {
               //       delegate.addViewControllers(registry);
               //   }
              }
          }
	}
</code></pre>

<p>​   3）、容器中所有的WebMvcConfigurer都会一起起作用；</p>

<p>​   4）、我们的配置类也会被调用；</p>

<p>​   效果：SpringMVC的自动配置和我们的扩展配置都会起作用；</p>

<h3 id="3-全面接管springmvc">3、全面接管SpringMVC；</h3>

<p>SpringBoot对SpringMVC的自动配置不需要了，所有都是我们自己配置；所有的SpringMVC的自动配置都失效了</p>

<p><strong>我们需要在配置类中添加@EnableWebMvc即可；</strong></p>

<pre><code class="language-java">//使用WebMvcConfigurerAdapter可以来扩展SpringMVC的功能
@EnableWebMvc
@Configuration
public class MyMvcConfig extends WebMvcConfigurerAdapter {

    @Override
    public void addViewControllers(ViewControllerRegistry registry) {
       // super.addViewControllers(registry);
        //浏览器发送 /atguigu 请求来到 success
        registry.addViewController(&quot;/atguigu&quot;).setViewName(&quot;success&quot;);
    }
}
</code></pre>

<p>原理：</p>

<p>为什么@EnableWebMvc自动配置就失效了；</p>

<p>1）@EnableWebMvc的核心</p>

<pre><code class="language-java">@Import(DelegatingWebMvcConfiguration.class)
public @interface EnableWebMvc {
</code></pre>

<p>2）、</p>

<pre><code class="language-java">@Configuration
public class DelegatingWebMvcConfiguration extends WebMvcConfigurationSupport {
</code></pre>

<p>3）、</p>

<pre><code class="language-java">@Configuration
@ConditionalOnWebApplication
@ConditionalOnClass({ Servlet.class, DispatcherServlet.class,
		WebMvcConfigurerAdapter.class })
//容器中没有这个组件的时候，这个自动配置类才生效
@ConditionalOnMissingBean(WebMvcConfigurationSupport.class)
@AutoConfigureOrder(Ordered.HIGHEST_PRECEDENCE + 10)
@AutoConfigureAfter({ DispatcherServletAutoConfiguration.class,
		ValidationAutoConfiguration.class })
public class WebMvcAutoConfiguration {
</code></pre>

<p>4）、@EnableWebMvc将WebMvcConfigurationSupport组件导入进来；</p>

<p>5）、导入的WebMvcConfigurationSupport只是SpringMVC最基本的功能；</p>

<h2 id="5-如何修改springboot的默认配置">5、如何修改SpringBoot的默认配置</h2>

<p>模式：</p>

<p>​   1）、SpringBoot在自动配置很多组件的时候，先看容器中有没有用户自己配置的（@Bean、@Component）如果有就用用户配置的，如果没有，才自动配置；如果有些组件可以有多个（ViewResolver）将用户配置的和自己默认的组合起来；</p>

<p>​   2）、在SpringBoot中会有非常多的xxxConfigurer帮助我们进行扩展配置</p>

<p>​   3）、在SpringBoot中会有很多的xxxCustomizer帮助我们进行定制配置</p>


    
  </section>
  <div class="divider my-gap"></div>
  <footer class="col-12 d-inline-block">
    <span class="float-left">
      <button class="btn btn-action btn-accent shadow s-circle" onclick="window.history.back();"><i class="fas fa-arrow-left"></i></button>
    </span>
    <span class="float-right">
      <div class="text-right float-left mx-2">
        <span class="text-dark">rui</span><br>
        <span class="text-gray">黑丑</span>
      </div>
      <figure class="avatar avatar-lg">
        <img id="profile">
      </figure>
    </span>
  </footer>
</article>

    <footer class="container p-centered text-center my-gap">
  
    <div class="container">

  
    <a class="symbol" href="mailto:dongr12138@gmail.com" target="_blank"><i class="fas fa-envelope"></i>
  
  </a>

  
    <a class="symbol" href="https://github.com/dongr12138/dongr12138.github.io/" target="_blank"><i class="fab fa-github"></i>
  
  </a>

</div>

  

  <small class="text-gray">
  
    © Copyright 2019 rui
  
  </small>
</footer>

  </div>
  </section>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script src="https://dongr12138.github.io/js/main.js"></script>
<script src="https://dongr12138.github.io/js/highlight.js"></script>
<script>hljs.initHighlightingOnLoad();</script>





</body>
</html>
